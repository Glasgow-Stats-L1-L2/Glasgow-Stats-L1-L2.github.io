# Exercise 1 - Transformation of Predictors

The data frame SIMDATAXT contains simulated data for the response, y, and predictors, $x_1$, $x_2$, and $x_3$.
We will apply appropriate transformations to $x_1$, $x_1$, and$x_1$ to linearise the relationships between the response and predictors one at a time.<br>
*Remember that when you use operators such as* $\text{+, -, ^, *, }$ *you must use the identity function, * $I()$ *, to inhibit the interpretation of your formula operator as an arithmetic operator*

<br> (a) Below are some questions to help you follow the right steps. Starting with $x_1$:

(i) Does the plot of $x_1$ against $Y$ appear linear? `r mcq(c("Yes", answer=  "No"))`

(ii) Which transformation produces a scatterplot that seem to present a linear relationship? `r mcq(c(answer = "Square-root x", "inverse of x (1/x)", "x squared", "No transformation"))`

(iii) Do both the residual plots, as well as the and the coefficient of determination, $R^2$ support this transformed model?<p>
If no, go back to *ii.*
<br>


```{r eval = TRUE, echo = TRUE, webex.hide="Solution"}
# Plot of x1 against Y
plot(y ~ x1, data = SIMDATAXT) # This appears non-linear

# Plot of data with a square root transformation
plot(y ~ I(x1^0.5), data = SIMDATAXT) # This appears linear

# Define your linear model
Model1 <- lm(y ~ I(x1^0.5), data = SIMDATAXT)

# Get the residual plots
plot(rstandard(Model1) ~ fitted(Model1))
qqnorm(rstandard(Model1))



#Get the coefficient of determination, R-squared
summary(Model1)
# 0.8853 is high enough to indicate a good fit and the assumpions here are met.
```

<br>(b) Repeat for $x_2$
```{r eval = TRUE, echo = TRUE, webex.hide="Solution"}
# Plot of x2 against Y
plot(y ~ x2, data = SIMDATAXT) # This appears non-linear

# Plot of data with a squared transformation
plot(y ~ I(x2^2), data = SIMDATAXT) # This appears linear

# Define your linear model
Model1 <- lm(y ~ I(x2^2), data = SIMDATAXT)

# Get the residual plots
plot(rstandard(Model1) ~ fitted(Model1))
qqnorm(rstandard(Model1))



#Get the coefficient of determination, R-squared
summary(Model1)
# 0.885 is high enough to indicate a good fit and the assumpions here are met.
```

<br>(c) Repeat for $x_3$
```{r eval = TRUE, echo = TRUE, webex.hide="Solution"}
# Plot of x3 against Y
plot(y ~ x3, data = SIMDATAXT) # This appears non-linear

# Plot of data with an inverse transformation
plot(y ~ I(x3^-1), data = SIMDATAXT) # This appears linear

# Define your linear model
Model1 <- lm(y ~ I(x3^-1), data = SIMDATAXT)

# Get the residual plots
plot(rstandard(Model1) ~ fitted(Model1))
qqnorm(rstandard(Model1))



#Get the coefficient of determination, R-squared
summary(Model1)
# 0.885 is high enough to indicate a good fit and the assumpions here are met.
```


<br>(d) Which selection of variables therefore needed to be transformed?
`r mcq(c("x1", "x2", "x3", "x1, x2", "x1, x3", "x2, x3", answer = "x1, x2, x3", "none of the above"))`
